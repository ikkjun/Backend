# CHAPTER 09 클라이언트와의 대화 1 : 쿠키
웹 서버는 쿠키를 이용해서 웹 브라우저에 정보를 전송할 수 있다. 
웹 서버로부터 쿠키를 전달받은 웹 브라우저는 이후 웹 서버에 요청을 보낼 때 쿠키를 함께 전송한다.
이를 사용하면 웹 서버와 웹 브라우저는 필요한 값을 공유하고 상태를 유지할 수 있다.

## 01 쿠키 사용하기 
쿠키(cookie)는 웹 브라우저가 보관하는 데이터이다.
웹 브라우저는 웹 서버에 요청을 보낼 때 쿠키를 함께 전송하며, 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해서 필요한 데이터를 읽을 수 있다.

#### 쿠키 동작 방식
1. 쿠키 생성 단계 <br>쿠키를 사용하려면 먼저 쿠키를 생성해야 한다. JSP 프로그래밍에서 쿠키는 웹 서버 측에서 생성한다. 생성한 쿠키를 응답 데이터의 헤더에 저장해서 웹 브라우저에 전송한다.
2. 쿠키 저장 단계<br>웹 브라우저는 응답 데이터에 포함된 쿠키를 쿠키 저장소에 보관한다. 쿠키의 종류에 따라 메모리나 파일에 저장한다.
3. 쿠키 전송 단계<br>웹 브라우저는 저장한 쿠키를 요청이 있을 때마다 웹 서버에 전송한다. 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해서 필요한 작업을 수행한다.

일단 웹 브라우저에 쿠키가 저장되면 웹 브라우저는 쿠키가 삭제되기 전까지 웹 서버에 쿠키를 전송한다.


### 1.1 쿠키의 구성
- 이름
- 값
- 유효시간
- 도메인
- 경로

### 1.2 쿠키 생성하기
```java
<%
    Cookie cookie = new Cookie("cookieName", "cookieValue");
    response.addCookie(cookie);
%>
```

위 코드에서 첫 번째 줄은 쿠키 정보를 담고 있는 Cookie 객체를 생성한다.
생성할 쿠키 정보를 담고 있는 Cookie 객체를 생성했다면, response 기본 객체의 메서드의 addCookie() 메서드를 이용하여 쿠키를 추가하면 된다.

### 1.3 쿠키 값 읽어오기
```java
Cookie[] cookies = request.getCookies();
```

### 1.4 쿠키 값 변경 및 쿠키 삭제하기
쿠키의 값을 변경한다는 것은 기존에 존재하는 쿠키의 값을 변경한다는 것이다.
쿠키 값을 변경하려면 쿠키가 존재하는지 먼저 확인해야 한다. 

쿠키를 삭제하려면 Cookie 클래스의 setMaxAge() 메서드를 호출할 때 인자 값으로 0을 주면 된다.

### 1.5 쿠키의 도메인
기본적으로 쿠키느 그 쿠키를 생성한 서버에만 전송된다.
하지만, 같은 도메인을 사용하는 모든 서버에 쿠키를 보내야 할 때가 있다.
setDomain() 메서드는 생성한 쿠키를 전송할 수 있는 도메인을 지정한다.
도메인을 지정할 때 주의할 점은 setDomain()의 값으로 현재 서버의 도메인 및 상위 도메인만 전달할 수 있다는 것이다.

JSESSIONID인 쿠키가 존재하는데, 이 쿠키는 JSP/서블릿에서 세션 관리를 위해 사용된다.

### 1.6 쿠키의 경로
도메인이 쿠키를 공유할 도메인 범위를 지정한다면, 경로는 쿠키를 공유할 기준 경로를 지정한다.

### 1.7 쿠키의 유효시간
쿠키는 유효시간을 갖는다. 쿠키의 유효시간을 지정하지 않으면 웹 브라우저를 종료할 때 쿠키를 함께 삭제한다.
쿠키의 유효시간을 정해 놓으면 그 유효시간 동안 쿠키가 존재하며, 웹 브라우저를 종료해도 유효시간이 지나지 않았으면 쿠키를 삭제하지 않는다.

유효시간을 지정하려면 setMaxAge()메서드를 사용한다. setMaxAge()는 초 단위로 유효시간을 지정한다.

### 1.8 쿠키와 헤더
response.addCookie()로 쿠키를 추가하면 실제로 Set-Cookie 헤더를 통해서 전달한다.

## 02 쿠키 처리를 위한 유틸리티 클래스
### 2.1 Cookies 클래스를 이용한 쿠키 생성
쿠키를 생성할 때는 Cookies.createCookie() 메서드를 사용한다.

### 2.2 Cookies 클래스를 이용한 쿠키 읽기
웹 브라우저가 전송한 쿠키를 읽으려면 Cookies 객체를 생성한 후 getCookie(), getValue(), exists() 등의 메서드를 사용하면 된다.

## 03 쿠키를 사용한 로그인 상태 유지
